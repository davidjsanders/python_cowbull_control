#!/usr/bin/env bash
source setup_variables
echo ""
echo "Deploy CowBull game to Kubernetes cluster running on Azure"
echo "=========================================================="
echo ""
echo "Configuration will be set as follows:"
echo "-------------------------------------"
echo ""
echo "resource group:   "$rg
echo "cluster name  :   "$clusterName
echo "master count  :   "$masters
echo "agent count   :   "$agents
echo "location      :   "$location
echo "machine type  :   "$machineType
echo "dns prefix    :   "$dnsPrefix
echo "cowbull dns   :   "$publicIpDNS"."$dnsPrefix"."$location".cloudapp.azure.com"
echo "private key   :   "$keyfile
echo ""
read -p "Continue (y for yes, anything else to quit)? " -n 1 -r
echo ""
if [[ ! $REPLY =~ ^[Yy]$ ]]
then
    echo "Exiting".
    exit 0
fi
echo ""
echo "Step 1. Deleting resource group (no wait specified) "$rg
az group delete --name $rg --yes --no-wait
echo ""
echo "Step 2. Reset controls to minikube"
kubectl config use-context minikube
echo ""
echo ""
echo "Done."
echo ""
echo "Next steps:"
echo "1. Verify the group is cleared      > az group list"
echo ""
